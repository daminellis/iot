
A máquina é uma separadora/contadora de peças e sua programação, com Arduino,
funciona da seguinte forma:
• Uma entrada de peças é realizada de forma automática por um alimentador vertical
• Para iniciar o processo, a esteira M1 é ligada, nível lógico 0 esteira está parada, nível
lógico 1 se movendo.
• Um Servomotor empurra as peças do alimentador para cima da esteira, posição 0 º
é a de descanso, posição 90 º coloca a peça na esteira.
• No meio da esteira tem um sensor que mede a altura das peças. As peças são
divididas em dois grupos:
◦ Peças pequenas, que tem altura máxima de 15 cm;
◦ Peças grandes, que são maiores que 16 cm e com altura máxima de 30 cm;
◦ O sensor está posicionado a 45 cm da esteira, apontado para baixo.
• Ao final da esteira, as peças devem ser colocadas em suas respectivas caixas de
armazenamento. Um posicionador utilizando servomotor direciona as peças para
suas respectivas caixas.
◦ Posição de descanso deste posicionador é 90 º.
◦ Para direcionar as peças pequenas, o posicionador vai para 120 º.
◦ Para direcionar as peças grandes, o posicionador vai para 60 º.
• Na entrada de cada caixa de armazenamento tem um sensor que realiza a contagem
de peças esta contagem deve ser atualizada e apresentada no Monitor Seria toda
vez que uma peça é armazenada.
==================================================================================
#include <Servo.h>
#include <Ultrasonic.h>
Ultrasonic distancia(12, 13);
int distanciaSensor;
const int sensor = A0;
int val;

Servo servo1;
Servo servo2;

const int botaoP = 2;
const int botaoG = 3;
const int alarme = 4;
const int rset = 5;
const int led = 7;

int contadorPequenas = 0;
int contadorGrandes = 0;

int alturaMaximaPequenas = 15;
int alturaMaximaGrandes = 30;

void setup() {
  servo1.attach(10);
  servo2.attach(9);
  pinMode(botaoP, INPUT);
  pinMode(botaoG, INPUT);
  pinMode(alarme, INPUT);
  pinMode(rset, INPUT);
  pinMode(led, OUTPUT);
  Serial.begin(9600);
}

void loop() {
  distanciaSensor = distancia.read();
  val = analogRead(sensor);

  if (digitalRead(alarme) == LOW) {
    digitalWrite(led, HIGH);
  } else {
    digitalWrite(led, LOW);
  }

  for (int pos = 0; pos <= 90;) {
    servo1.write(pos);
    delay(15);
  }

  if (distanciaSensor <= alturaMaximaPequenas) {
    servo2.write(120);
  } else if (distanciaSensor <= alturaMaximaGrandes) {
    servo2.write(60);
  }

  if (digitalRead(botaoP) == HIGH) {
    contadorPequenas++;
  } else if (digitalRead(botaoG) == HIGH) {
    contadorGrandes++;
  }

  servo2.write(90);

  Serial.print("Pecas Pequenas: ");
  Serial.println(contadorPequenas);
  Serial.print("Pecas Grandes: ");
  Serial.println(contadorGrandes);
}
